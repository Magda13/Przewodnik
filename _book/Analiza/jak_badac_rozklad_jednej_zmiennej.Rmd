# Jak badać rozkład jednej zmiennej?

W tym rozdziale przedstawimy podstawowe narzędzia analizy rozkładu zmiennych ilościowych i jakościowych.
Wykorzystamy do tego bazę danych dotyczących posłów z 8 kadencji Sejmu.
Dane pobierane są bezpośrednio z Internetu z serwisu GitHub.

```{r}
poslowie <- archivist::aread("pbiecek/Przewodnik/arepo/07088eb35cc2c9d2a2a856a36b3253ad")

head(poslowie)
```

## Zmienna ilościowa

W zbiorze danych `poslowie` mamy kilka zmiennych ilościowych. 

Czy potrafisz je wskazać? 

Z pewnością należą do nich `Wiek` i `Glosow`. 

### Średnia

Jaki jest średni wiek posłów?

$$
\bar x = \sum_{i=1}^n x_i / n.
$$

```{r}
mean(poslowie$Wiek)
```

### Średnia Windsorowska

A średnia obcięta, wyznaczona na podstawie 60\% środkowych obserwacji?

```{r}
mean(poslowie$Wiek, trim=0.2)
```

### Mediana

Mediana bliska średniej, czyżby brak skośności?

```{r}
median(poslowie$Wiek)
```

### Odchylenie standardowe

Odchylenie standardowe zmiennej wiek.

$$
\bar \sigma = \sqrt{sum_{i=1}^n (x_i - \bar x)^2 / (n-1)}
$$

```{r}
sd(poslowie$Wiek)
```

### Rozstęp

Jaka jest najmniejsza i największa wartość przyjmowana przez zmienną Wiek?

```{r}
range(poslowie$Wiek)
```

### Rozstęp kartylowy

Ile wynosi rozstęp kwartylowy (różnica pomiędzy 3. a 1. kwartylem)?

```{r}
IQR(poslowie$Wiek)
```

### Kurtoza / miara spłaszczenia

Aby ją wyznaczyć potrzebujemy pakietu `e1071`.

Kurtozę można liczyć na kilka sposobów. 

Typ: 1

$$
g_2 = m_4 / m_2^2 - 3.
$$

Typ: 2 (domyślny w SAS i SPSS), nieobciążony estymator kurtozy dla r. normalnego.

$$
G_2 = ((n+1) g_2 + 6) * (n-1) / ((n-2)(n-3))
$$

Typ: 3 (domyślny w R)

$$
b_2 = m_4 / s^4 - 3 = (g_2 + 3) (1 - 1/n)^2 - 3.
$$

Więcej o porównaniu tych estymatorów *D. N. Joanes and C. A. Gill (1998), Comparing measures of sample skewness and kurtosis. The Statistician, 47, 183–189.*

```{r}
library(e1071)
kurtosis(poslowie$Wiek)
```

### Skośność

Przyjmując $$m_r = \sum_i (x_i - mu)^r / n$$

Typ: 1

$$
g_1 = m_3 / m_2^(3/2)
$$

Typ: 2 (domyślny w SAS i SPSS),

$$
G_1 = g_1 * sqrt(n(n-1)) / (n-2).
$$

Typ: 3 (domyślny w R)

$$
b_1 = m_3 / s^3 = g_1 ((n-1)/n)^(3/2).
$$

Wszystkie trzy estymatory są nieobciążone dla modelu normalnego.

```{r}
skewness(poslowie$Wiek)
```


### Kwantyle

Wybrane kwantyle zmiennej wiek.

W pakiecie R zaimplementowanych jest 9 różnych metod liczenia kwantyli, zobacz argument type.

```{r}
quantile(poslowie$Wiek, c(0.1, 0.25, 0.5, 0.75, 0.9))
```

### Odchylenie medianowe

Odchylenie medianowe

$$
mad = 1.4826 * median(abs(x - median(x)))
$$

Stała $$1.4826 \approx 1/ \Phi^(-1)(3/4)$$ jest wybrana by wartość oczekiwana była równa odchyleniu standardowemu dla modelu normalnego.

```{r}
mad(poslowie$Wiek)
```

### Najwazniejsze statystyki

```{r}
summary(poslowie$Wiek)
```

### Wykres pudełkowy

```{r}
boxplot(poslowie$Wiek, col="grey", horizontal = TRUE)
```

### Histogram

Histogram jest bez wątpienia najpopularniejszą statystyką graficzną przedstawiającą rozkład jednej zmiennej. 
Przedstawia liczeby wartości zmiennej w poszczególnych przedziałach (te przedziały nazywane są również klasami lub kubełkami). Deklaracja tej funkcji (pomijając argumenty graficzne) jest następująca:

```
hist(x, breaks = "Sturges", freq = NULL, probability = !freq,
     right = TRUE, plot = TRUE, labels = FALSE, ...)
```

Argument `x` określa wektor wartości, dla których histogram ma być wyznaczony, argument `breaks` określa podział zakresu zmienności wektora `x` na przedziały, argument `freq` określa, czy przy rysowaniu histogramu mają być zaznaczane frakcje, czy liczebności elementów w przedziałach. Argument `right` określa, czy przedziały mają być traktowane jako domknięte prawostronnie, czy lewostronnie, argument `plot` określa, czy histogram ma być rysowany, czy tylko wyznaczany ma być opis histogramu, argument `labels` pozwala na wskazanie wektora napisów, które będą naniesione na słupki odpowiadające kolejnym przedziałom.

Jeżeli nie podamy liczby przedziałów, to zostanie ona dobrana w~zależności od liczby obserwacji oraz zmienności danej zmiennej. Do określania liczby i szerokości przedziałów służy argument `breaks`. Jeżeli podamy za wartość tego argumentu liczbę, to będzie ona potraktowana jako sugestia oczekiwanej liczby automatycznie wyznaczonych przedziałów (tylko sugestia ponieważ funkcja `hist()` może liczbę nieznacznie zwiększyć lub zmniejszyć). Jeżeli podany będzie wektor liczb, to będzie on uznany za wektor punktów rozdzielających przedziały (przedziały nie muszą mieć równych szerokości). Jeżeli argumentem będzie napis, to zostanie on zinterpretowany jako nazwa algorytmu do wyznaczenia liczby przedziałów (możliwe wartości to `"Sturges"`, `"Scott"`, `"FD"` i `"Freedman-Diaconis"`. 

```{r}
hist(poslowie$Wiek, col="grey")
```

Domyślnie, funkcja `hist()` na osi poziomej zaznacza liczebności obserwacji w~poszczególnych klasach. Jeżeli chcemy wyznaczyć proporcje, to należy funkcji `hist()` podać argument `freq=FALSE` lub (równoważnie) `probability=TRUE`.

### Dystrybuanta empiryczna

```{r}
plot(ecdf(poslowie$Wiek), las=1)
```

### Jądrowy estymator gęstości

```{r}
plot(density(poslowie$Wiek, bw=1), las=1)
plot(density(poslowie$Wiek, bw=3), las=1)
```

## Zmienna jakościowa



- dla zmiennych ciągłych, dyskretnych, ciągłych z atomem
- estymator jądrowy gęstości (histogram)
- ecdf
- testy zgodności
